# 金融行情简报发布技能 - 安装使用指南

## 🎉 技能已创建完成！

您的金融行情简报发布技能已成功打包为专业的技能包。

---

## 📦 技能包信息

**文件名**: `financial-report-publisher.skill`  
**大小**: 16.19 KB  
**版本**: v1.0  
**创建日期**: 2026-02-13

```desktop-local-file
{
  "localPath": "E:\\jieyue_data\\financial-report-publisher.skill",
  "fileName": "financial-report-publisher.skill"
}
```

---

## 📋 技能包含内容

### 核心文件
- **SKILL.md** - 技能说明文档（触发器和使用指南）
- **market_report_publisher.py** - 主程序（300+行完整实现）
- **config.json.example** - 配置文件模板

### 参考文档
- **data-sources.md** - 数据源集成指南
  - 东方财富API
  - 新浪财经API
  - Tushare Pro
  - 网络爬取方案
  
- **wechat-api.md** - 微信公众号API完整参考
  - Access Token获取
  - 素材上传
  - 草稿创建
  - 错误处理

---

## 🚀 安装方式

### 方式1：通过小跃安装（推荐）

1. 在对话框中说："帮我安装这个技能"
2. 上传 `financial-report-publisher.skill` 文件
3. 小跃会自动解压并安装到技能目录

### 方式2：手动安装

1. 将 `financial-report-publisher.skill` 文件重命名为 `.zip`
2. 解压到小跃技能目录：`C:\Users\你的用户名\.stepfun\skills\`
3. 重启小跃

---

## ⚙️ 配置步骤

安装后需要配置API密钥：

1. 找到技能目录中的 `config.json.example`
2. 复制为 `config.json`
3. 填写以下信息：

```json
{
  "wechat": {
    "appid": "wx1234567890abcdef",
    "secret": "1234567890abcdef1234567890abcdef"
  },
  "aliyun": {
    "api_key": "sk-1234567890abcdef"
  }
}
```

**获取微信公众号凭证：**
- 登录 https://mp.weixin.qq.com
- 进入"开发" → "基本配置"
- 复制 AppID 和 AppSecret

---

## 💬 使用技能

安装配置完成后，在对话中这样触发技能：

### 触发示例

- "帮我生成今日金融行情简报并发布到微信公众号"
- "发布今天的A股、美股、期货收盘简报"
- "创建行情晚报草稿"
- "生成金融市场收盘报告"

### 技能会自动：

1. ✅ 获取微信公众号access_token
2. ✅ 生成带有"行情晚报"和日期的专业封面
3. ✅ 格式化HTML行情简报内容
4. ✅ 上传封面到微信公众号
5. ✅ 创建草稿到公众号后台

### 执行结果

- 封面图片：深蓝金色渐变，清晰显示标题和日期
- 简报内容：包含A股、美股、期货完整数据
- 草稿位置：微信公众号后台 → 素材管理 → 草稿箱

---

## 🔧 技能特性

### 已解决的问题

✅ **编码问题** - 完美支持UTF-8中文，不再乱码  
✅ **封面生成** - 本地PIL生成，文字清晰准确  
✅ **日期正确** - 自动使用当前日期  
✅ **标题长度** - 优化为简洁格式，符合微信限制  
✅ **错误处理** - 完整的异常捕获和友好提示  

### 技术栈

- Python 3.7+
- requests - HTTP请求
- Pillow - 图像生成
- 微信公众号API
- UTF-8编码处理

---

## 📚 扩展功能

技能支持进一步定制：

### 1. 集成实时数据

参考 `references/data-sources.md`，集成：
- 东方财富API
- 新浪财经API
- Tushare Pro

### 2. 自定义封面

修改封面样式：
- 背景颜色
- 字体大小
- 装饰元素

### 3. 定时发布

设置Windows任务计划程序或Linux Cron自动执行

---

## 📖 文档说明

### SKILL.md 触发描述

技能在SKILL.md中定义了清晰的触发条件：

```yaml
description: 自动生成并发布金融行情简报到微信公众号。
当用户需要：
(1) 生成A股、美股、期货收盘行情简报
(2) 自动发布金融市场数据到微信公众号草稿箱
(3) 创建带有专业封面的金融晚报
(4) 定期发布市场行情汇总
时使用此技能。
```

这意味着当你的请求涉及"金融"、"行情"、"简报"、"微信公众号"等关键词时，小跃会自动加载这个技能。

---

## ❓ 常见问题

### Q1: 如何验证技能是否安装成功？
**A**: 在对话中询问："你有哪些技能？"或"列出可用技能"

### Q2: 技能触发但执行失败？
**A**: 检查 `config.json` 是否正确配置了微信AppID和Secret

### Q3: 如何更新技能？
**A**: 删除旧版本技能目录，重新安装新的.skill文件

### Q4: 可以同时管理多个公众号吗？
**A**: 可以，创建多个config文件，每次指定不同配置

---

## 🎯 下一步

1. **安装技能** - 使用上述方式安装技能包
2. **配置密钥** - 填写微信和阿里云API密钥
3. **测试运行** - 尝试生成第一份行情简报
4. **定时发布** - 设置每日自动执行任务

---

## 💡 提示

- 技能已包含完整的300+行生产级代码
- 所有已知问题已在v1.0中修复
- 支持通过对话直接调用，无需手动执行脚本
- 参考文档提供了完整的API集成方案

祝使用愉快！🚀
