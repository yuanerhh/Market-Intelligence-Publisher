# 金融行情早报+晚报系统 - 完整说明

## 🎯 系统概述

您现在拥有一个完整的金融行情自动发布系统，包含**早报**和**晚报**两个功能。

---

## 📊 功能对比

| 项目 | 早报 | 晚报 |
|------|------|------|
| **发布时间** | 每天 7:00 | 每天 15:30 |
| **封面颜色** | 橙红到金黄（朝阳） | 深蓝到金色（专业） |
| **封面装饰** | 太阳图标 | 上涨箭头 |
| **主要内容** | 隔夜美股收盘 | A股收盘行情 |
| **次要内容** | 亚太市场、市场要闻 | 美股最新、商品期货 |
| **特色板块** | 今日关注、早间观点 | 市场观察 |
| **脚本文件** | `morning_report_publisher.py` | `market_report_publisher.py` |

---

## 📁 文件清单

### 核心脚本
```
E:\jieyue_data\
├── morning_report_publisher.py          # 早报主程序
├── market_report_publisher.py           # 晚报主程序
├── config.json                          # 配置文件（共用）
├── 一键配置定时任务.ps1                 # 定时任务配置脚本
├── 定时任务完整配置指南.md              # 详细配置文档
└── run_report.bat                       # 简易运行脚本
```

### 技能包
```
E:\jieyue_data\
└── financial-report-publisher\          # 晚报技能包目录
    ├── SKILL.md
    ├── scripts\
    │   └── market_report_publisher.py
    └── references\
        ├── data-sources.md
        └── wechat-api.md
```

### 生成的文件
```
E:\jieyue_data\
├── cover_*.jpg                          # 晚报封面图片
├── morning_cover_*.jpg                  # 早报封面图片
└── logs\                                # 日志目录（可选）
    ├── morning_*.log
    └── evening_*.log
```

---

## 🚀 快速开始

### 1️⃣ 手动测试

**测试早报：**
```cmd
python E:\jieyue_data\morning_report_publisher.py
```

**测试晚报：**
```cmd
python E:\jieyue_data\market_report_publisher.py
```

### 2️⃣ 配置定时任务

**方式A：一键配置（推荐）**
1. 右键点击 `一键配置定时任务.ps1`
2. 选择"使用PowerShell运行"
3. 如果提示权限，选择"以管理员身份运行"
4. 按提示完成配置

**方式B：手动配置**
参考 `定时任务完整配置指南.md`

### 3️⃣ 验证定时任务

```cmd
# 查看任务列表
schtasks /query /tn "金融行情早报发布"
schtasks /query /tn "金融行情晚报发布"

# 立即测试运行
schtasks /run /tn "金融行情早报发布"
schtasks /run /tn "金融行情晚报发布"
```

---

## 📝 早报内容结构

```
【封面】行情早报 + 日期（橙红金黄渐变 + 太阳图标）

【正文】
美股市场（昨日收盘）
  ├─ 主要指数（道指、标普、纳指、VIX）
  ├─ 领涨板块
  ├─ 领跌板块
  └─ 明星个股（涨幅榜、跌幅榜）

亚太市场
  └─ 主要指数（日经、韩综、恒指）

市场要闻
  ├─ 宏观经济
  ├─ 公司动态
  └─ 商品期货

今日关注
  ├─ A股市场展望
  └─ 重要数据时间表

早间观点
  └─ 市场分析和投资建议
```

---

## 📝 晚报内容结构

```
【封面】行情晚报 + 日期（深蓝金色渐变 + 上涨箭头）

【正文】
A股市场
  ├─ 主要指数（上证、深证、创业板）
  ├─ 领涨板块
  └─ 领跌板块

美股市场
  └─ 主要指数（道指、标普、纳指）

商品期货市场
  ├─ 贵金属
  ├─ 能源化工
  └─ 工业金属

市场观察
  └─ 当日市场总结
```

---

## 🎨 封面对比

### 早报封面
- **颜色**：橙红(#FF8C00) → 金黄(#FFD700)
- **主题**：朝阳、新的一天
- **装饰**：太阳图标 + 光芒
- **文字**："行情早报" + 日期

### 晚报封面
- **颜色**：深蓝(#0D1B3E) → 金色(#DAA520)
- **主题**：专业、稳重
- **装饰**：金色线条 + 上涨箭头
- **文字**："行情晚报" + 日期

---

## ⚙️ 配置说明

### config.json（两个脚本共用）

```json
{
  "wechat": {
    "appid": "YOUR_WECHAT_APPID",
    "secret": "YOUR_WECHAT_SECRET"
  },
  "aliyun": {
    "api_key": "YOUR_ALIYUN_API_KEY"
  }
}
```

**注意**：早报和晚报使用同一个配置文件，发布到同一个公众号。

---

## 📅 执行时间规划

### 早报（7:00）
- **适合人群**：早起上班族、投资者
- **阅读场景**：通勤路上、早餐时间
- **内容重点**：隔夜美股、今日展望

### 晚报（15:30）
- **适合人群**：A股投资者、关注收盘
- **阅读场景**：收盘后、下班前
- **内容重点**：A股总结、美股预览

---

## 🔧 自定义修改

### 修改发布时间

**早报改为6:30：**
```powershell
# 修改 一键配置定时任务.ps1 中的
$morningTrigger = New-ScheduledTaskTrigger -Daily -At 6:30AM
```

**晚报改为16:00：**
```powershell
$eveningTrigger = New-ScheduledTaskTrigger -Daily -At 4:00PM
```

### 修改内容

**早报内容：** 编辑 `morning_report_publisher.py` 中的 `generate_morning_report()` 方法

**晚报内容：** 编辑 `market_report_publisher.py` 中的 `generate_market_report()` 方法

### 修改封面

**早报封面：** 编辑 `morning_report_publisher.py` 中的 `generate_cover_image()` 方法

**晚报封面：** 编辑 `market_report_publisher.py` 中的 `generate_cover_image()` 方法

---

## 📊 数据更新

### 当前使用示例数据

两个脚本目前都使用示例数据。要使用实时数据，可以：

1. **集成API** - 参考 `references/data-sources.md`
   - 东方财富API
   - 新浪财经API
   - Tushare Pro

2. **网络爬取** - 使用BeautifulSoup或Selenium

3. **手动更新** - 每天修改脚本中的数据

---

## 🎯 使用建议

### 工作日模式
- **周一至周五**：早报 + 晚报都发布
- **周末**：可以禁用或只发布早报（美股周末不开盘）

### 节假日处理
```cmd
# 临时禁用任务
schtasks /change /tn "金融行情早报发布" /disable
schtasks /change /tn "金融行情晚报发布" /disable

# 节后重新启用
schtasks /change /tn "金融行情早报发布" /enable
schtasks /change /tn "金融行情晚报发布" /enable
```

---

## 📈 监控和维护

### 日常检查
1. **每周一次**：查看任务执行历史
2. **每月一次**：检查日志文件
3. **定期**：验证微信草稿箱

### 故障排查
1. 检查Python环境
2. 检查网络连接
3. 检查config.json配置
4. 查看日志文件
5. 手动运行脚本测试

---

## 📚 相关文档

```desktop-local-file
{
  "localPath": "E:\\jieyue_data\\定时任务完整配置指南.md",
  "fileName": "定时任务完整配置指南.md"
}
```
**详细的定时任务配置说明**

```desktop-local-file
{
  "localPath": "E:\\jieyue_data\\一键配置定时任务.ps1",
  "fileName": "一键配置定时任务.ps1"
}
```
**一键配置PowerShell脚本**

---

## ✅ 检查清单

在正式使用前，请确认：

- [ ] config.json已正确配置
- [ ] 早报脚本手动测试成功
- [ ] 晚报脚本手动测试成功
- [ ] 定时任务已创建
- [ ] 定时任务测试运行成功
- [ ] 微信草稿箱能看到生成的内容
- [ ] 封面图片显示正确
- [ ] 内容格式正确无乱码

---

## 🎉 总结

您现在拥有：
- ✅ 完整的早报系统（美股+市场要闻）
- ✅ 完整的晚报系统（A股+期货）
- ✅ 自动化定时任务配置
- ✅ 专业的封面图片生成
- ✅ 详细的配置和使用文档

每天自动发布两次金融行情简报，为您的读者提供及时、专业的市场资讯！🚀
